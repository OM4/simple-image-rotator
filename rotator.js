var $j=jQuery.noConflict();function ChangeImage(e,d){var a,c,b;if(d===undefined){d="next"}a="#"+e;if(rotatorSettings[e]["intransition"]){debug(a+" ChangeImage() called during transition period -> ignoring request");return}c=$j(a+" img.active");if(d=="next"){b=$j(c).next("img")}else{if(d=="previous"){b=$j(c).prev("img")}}if(b.length){}else{if(d=="next"){b=$j(a+" img:first");rotatorSettings[e]["imagenumber"]=0}else{b=$j(a+" img:last");rotatorSettings[e]["imagenumber"]=rotatorSettings[e]["totalnumimages"]+1}debug(a+" imagenumber reset to "+rotatorSettings[e]["imagenumber"]);rotatorSettings[e]["cyclecount"]+=1;debug(a+" completed cycle #"+rotatorSettings[e]["cyclecount"]+" of "+rotatorSettings[e]["cycles"]);if(rotatorSettings[e]["cycles"]>0&&rotatorSettings[e]["cycles"]==rotatorSettings[e]["cyclecount"]){StopRotator(e);return}}StartImageTransition(e);$j(b).addClass("next").fadeTo(rotatorSettings[e]["transition"],1,function(){$j(this).addClass("active");if(d=="next"){rotatorSettings[e]["imagenumber"]+=1}else{if(d=="previous"){rotatorSettings[e]["imagenumber"]-=1}}debug(a+" imagenumber "+rotatorSettings[e]["imagenumber"]+": src="+$j(this).attr("src"));$j(a+" .navigation .imagenumber").html(rotatorSettings[e]["imagenumber"]);EndImageTransition(e)});$j(c).removeClass("next").fadeTo(rotatorSettings[e]["transition"],0,function(){$j(this).removeClass("active")})}jQuery(document).ready(function(g){var h,o=$j("div.simplerotator"),e=o.size(),b,l,m,n,d,c,a,k,j,f;for(h=0;h<e;h++){b=$j(o[h]).attr("id");rotatorSettings[b]["imagenumber"]=1;rotatorSettings[b]["intransition"]=false;rotatorSettings[b]["loadeventfired"]=false;$j("#"+b+" img.first").on("load",function(){if(rotatorSettings[b]["loadeventfired"]==true){return}rotatorSettings[b]["loadeventfired"]=true;l=$j(this).parents("div.simplerotator")[0];m=$j(l).attr("id");debug("#"+m+": running img.load() event for "+$j(this).attr("src"));if(rotatorSettings[m]["fullscreen"]){debug("#"+m+": initialising full screen rotator with offsets = T:"+rotatorSettings[m]["topoffset"]+" R:"+rotatorSettings[m]["rightoffset"]+" B:"+rotatorSettings[m]["bottomoffset"]+" L:"+rotatorSettings[m]["leftoffset"]+", losingside = "+rotatorSettings[m]["losingside"]+" and ensurefullscreen = "+rotatorSettings[m]["ensurefullscreen"]);$j("#"+m).css({position:"fixed",left:rotatorSettings[m]["leftoffset"],top:rotatorSettings[m]["topoffset"],"z-index":"-1"});n=$j(this);d=n.width()/n.height();function i(){switch(rotatorSettings[m]["losingside"]){case"bottom":rotatorSettings[m]["bottomoffset"]=0;break;case"right":rotatorSettings[m]["rightoffset"]=0;break}c=$j(window).width()-rotatorSettings[m]["leftoffset"]-rotatorSettings[m]["rightoffset"];a=$j(window).height()-rotatorSettings[m]["topoffset"]-rotatorSettings[m]["bottomoffset"];switch(rotatorSettings[m]["losingside"]){case"bottom":k=c;j=k/d;if(rotatorSettings[m]["ensurefullscreen"]&&j<a){debug("#"+m+": White space detected between the bottom of the image and the bottom of the browser window -> increasing image height (potentially chopping off the right hand side of the image)");j=a;k=j*d}break;case"right":j=a;k=j*d;if(rotatorSettings[m]["ensurefullscreen"]&&k<c){debug("#"+m+": White space detected between the right hand side of the image and the right hand side of the browser window -> increasing image width (potentially chopping off the bottom side of the image)");k=c;j=k/d}break}debug("#"+m+": browser window dimensions: "+$j(window).width()+" x "+$j(window).height());debug("#"+m+": adjusted window dimensions: "+c+" x "+a);debug("#"+m+": imgHeight:"+j+", windowHeight:"+a);$j("#"+m+" img").width(k).height(j)}i();$j(window).resize(i)}$j(l).css("height",$j(this).outerHeight(true)).css("width",$j(this).outerWidth(true));$j("#"+m+" img").removeClass("hidden first")});if(rotatorSettings[b]["loadeventfired"]==false&&$j("#"+b+" img.first").width()>0){$j("#"+b+" img.first").trigger("load")}if(rotatorSettings[b]["totalnumimages"]==1){continue}if(rotatorSettings[b]["shownavigation"]=="true"||rotatorSettings[b]["shownavigation"]=="onhover"){debug("#"+b+": navigation intialised");$j("#"+b+" .navigation").append("<ul>");$j("#"+b+" .navigation ul").append('<li class="nav prev enabled"><a href="#" title="Previous"><span>&larr;</span></a></li>').append('<li class="imagenumbers"><span class="imagenumber">1</span> / <span class="totalimages">'+rotatorSettings[b]["totalnumimages"]+"</span></li>").append('<li class="nav next enabled"><a href="#" title="Next"><span>&rarr;</span></a></li>').append("</ul>");if(rotatorSettings[b]["shownavigation"]=="true"){$j("#"+b+" .navigation").show();debug("#"+b+": navigation always shown")}else{if(rotatorSettings[b]["shownavigation"]=="onhover"){debug("#"+b+": navigation shown on hover only");$j("#"+b).hover(function(){debug("#"+b+": showing navigation");$j("#"+b+" .navigation").fadeIn()},function(){debug("#"+b+": hiding navigation");$j("#"+b+" .navigation").fadeOut()})}}$j("div.simplerotator .navigation li.nav").click(function(i){i.preventDefault();if(!$j(this).hasClass("disabled")){b=$j(this).closest("div.simplerotator").attr("id");if(rotatorSettings[b]["stoponnavigationclick"]){StopRotator(b)}if($j(this).hasClass("prev")){ShowPrevious(b)}else{if($j(this).hasClass("next")){ShowNext(b)}}}})}f=rotatorSettings[b]["startdelay"]-rotatorSettings[b]["interval"];if(f>0){setTimeout("SetupRotator('"+b+"')",f);debug("#"+b+": delaying the setup of this rotator for "+f+"ms")}else{SetupRotator(b)}}});function SetupRotator(a){debug("#"+a+": set up rotator to run with interval = "+rotatorSettings[a]["interval"]+"ms   transition = "+rotatorSettings[a]["transition"]+"ms");rotatorSettings[a]["intervalid"]=setInterval("ChangeImage('"+a+"')",rotatorSettings[a]["interval"]);rotatorSettings[a]["cyclecount"]=0}function StopRotator(a){if(rotatorSettings[a]["intervalid"]==0){return}clearInterval(rotatorSettings[a]["intervalid"]);rotatorSettings[a]["intervalid"]=0;debug("#"+a+" stopped after "+rotatorSettings[a]["cyclecount"]+" cycles")}function ShowNext(a){debug("#"+a+" ShowNext("+a+")");ChangeImage(a)}function ShowPrevious(a){debug("#"+a+" ShowPrevious("+a+")");ChangeImage(a,"previous")}function StartImageTransition(a){rotatorSettings[a]["intransition"]=true;if(rotatorSettings[a]["hidenavigationduringtransition"]){$j("#"+a+" .navigation ul li.nav").addClass("disabled").removeClass("enabled");debug("#"+a+": Hiding next/prev navigation buttons")}}function EndImageTransition(a){rotatorSettings[a]["intransition"]=false;if(rotatorSettings[a]["hidenavigationduringtransition"]){$j("#"+a+" .navigation ul li.nav").addClass("enabled").removeClass("disabled");debug("#"+a+": Showing next/prev navigation buttons")}}function debug(a){if(window.console){console.log(a)}};